import{_ as K,Q as oe}from"./_plugin-vue_export-helper-CMFwGJJn.js";import{r as g,c as T,O as ue,d as U,w,D as A,L as C,C as i,I as ce,l as de,h as pe,P as fe,Q as me,R as H,M as J,A as B,B as h,f as c,S as G,z as Q,H as y,G as n,y as ve,o as ge,U as he,V as xe,F as ye,N as Se,W as _e}from"./index-BTauGinS.js";import{u as W,d as F,i as we,j as Ce,e as X,f as Y,Q as Z,h as ee}from"./QDialog-CutJ4qGA.js";import{u as be,d as Le,a as ke,Q as I}from"./QBtn-CoBtsn9r.js";import"./firebase-r-X1VcmF.js";const te=60,Me=5,b=g(te),ae=g(Me),$=T(()=>{const e=Math.floor(b.value/60),a=b.value%60;return`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}`}),Te=T(()=>{const e=ae.value%60;return`${String(e).padStart(2,"0")}`}),le=T(()=>b.value<=0),Ve=()=>{b.value=te};function N(){let e=null,a=null;return{mounted:()=>{e=setInterval(()=>{b.value>=0?b.value--:e&&clearInterval(e)},1e3)},unmounted:()=>{e&&clearInterval(e)},mountedStart:()=>{a=setInterval(()=>{b.value>0?ae.value--:a&&clearInterval(a)},1e3)},isTimeOver:le}}const se=ue("game",{state:()=>({currentScore:0,pulseTimerList:["01:30","01:00","00:30"],attemptCounter:0,currentLevel:2,gameStartTime:null,gameEndTime:null,initialFlip:!1,lockBoard:!1,baseFruits:[{src:"fruits/abacaxi.png",alt:"abacaxi"},{src:"fruits/banana.png",alt:"banana"},{src:"fruits/banana.png",alt:"banana"},{src:"fruits/beterraba.png",alt:"beterraba"},{src:"fruits/carambola.png",alt:"carambola"},{src:"fruits/cereja.png",alt:"cereja"},{src:"fruits/kiwi.png",alt:"kiwi"},{src:"fruits/laranja.png",alt:"laranja"},{src:"fruits/limao.png",alt:"limao"},{src:"fruits/manga.png",alt:"manga"},{src:"fruits/melancia.png",alt:"melancia"},{src:"fruits/mixirica.png",alt:"mixirica"},{src:"fruits/morango.png",alt:"morgango"},{src:"fruits/pera.png",alt:"pera"},{src:"fruits/pessego.png",alt:"pessego"},{src:"fruits/pitaia.png",alt:"pitaia"},{src:"fruits/tamarindo.png",alt:"pitaia"},{src:"fruits/uva.png",alt:"uva"},{src:"fruits/uva_roxa.png",alt:"uva roxa"},{src:"fruits/uva_verde.png",alt:"uva verde"}],levelsConfig:[{level:1,gridSize:4,pairs:8},{level:2,gridSize:6,pairs:18},{level:3,gridSize:8,pairs:24},{level:4,gridSize:8,pairs:32}]}),getters:{currentConfig(e){return e.levelsConfig.find(t=>t.level===e.currentLevel)??e.levelsConfig[0]},gridSize(e){return e.levelsConfig.find(a=>a.level===e.currentLevel)?.gridSize||4},totalCards(e){return(e.levelsConfig.find(t=>t.level===e.currentLevel)?.pairs||8)*2},levelCardSet(e){const a=e.levelsConfig.find(l=>l.level===e.currentLevel)?.pairs||8,t=e.baseFruits.slice(0,a);return[...t,...t]}},actions:{startGameEffects(){const{audioCard:e}=F();this.initialFlip=!1,this.lockBoard=!0,setTimeout(()=>{this.gameStartTime=Date.now(),e(),this.initialFlip=!0,N().mountedStart(),setTimeout(()=>{e(),this.initialFlip=!1,N().mounted(),this.lockBoard=!1},5e3)},600)},incremetAttemptCounter(){this.attemptCounter+=1},incrementScore(e){const a=this.calculateScore(e);this.currentScore+=a},calculateScore(e){return e>="00:50"?5:e>="00:40"?4:e>="00:30"?3:e>="00:20"?2:e>="00:05"?1:0},resetScore(){this.currentScore=0},nextLevel(){const e=this.levelsConfig.length;this.currentLevel<e&&this.currentLevel++},resetLevel(){this.currentScore=0,this.attemptCounter=0,this.resetScore(),this.startGameEffects()},async endGame(){const e=W();this.gameEndTime=Date.now(),console.log(e.getUser?.uid),e.getUser?.uid&&await e.updateRanking(e.getUser.uid,{score:this.currentScore,gameTotal:this.attemptCounter,attemptCounter:this.attemptCounter,...e.getUser})}}}),Ee={class:"card-inner"},$e={class:"card-face card-front"},Be=["src","alt"],Ge=U({__name:"CardIndex",props:{card:{},index:{},flippedExternally:{type:Boolean},locked:{type:Boolean}},emits:["flip"],setup(e,{expose:a,emit:t}){const l=e,p=t,{audioCard:x}=F(),s=g(!1);w(()=>l.flippedExternally,f=>{s.value=f},{immediate:!0});const m=T(()=>s.value?"flip-up":"flip-down");function L(){l.locked||s.value||(s.value=!0,x(),p("flip",{index:l.index,alt:l.card.alt}))}return a({flipDown:()=>{x(),s.value=!1}}),(f,S)=>(C(),A("div",{class:ce(["card-container",m.value]),onClick:L,style:{"min-height":"60px","min-width":"60px"}},[i("div",Ee,[S[0]||(S[0]=i("div",{class:"card-face card-back"},null,-1)),i("div",$e,[i("img",{src:l.card.src,alt:l.card.alt,class:"card-img full-width full-height",width:"80",height:"80",loading:"lazy",style:{"max-width":"80px","max-height":"80px"}},null,8,Be)])])],2))}}),Ie=K(Ge,[["__scopeId","data-v-bf6819fa"]]),re=de({name:"QCardActions",props:{...be,vertical:Boolean},setup(e,{slots:a}){const t=Le(e),l=T(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>pe("div",{class:l.value},ke(a.default))}});function O(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}const P=fe({name:"close-popup",beforeMount(e,{value:a}){const t={depth:O(a),handler(l){t.depth!==0&&setTimeout(()=>{const p=we(e);p!==void 0&&Ce(p,l,t.depth)})},handlerKey(l){me(l,13)===!0&&t.handler(l)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:a,oldValue:t}){a!==t&&(e.__qclosepopup.depth=O(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}}),Pe=U({__name:"ModalFailedGame",props:{modelValue:{default:!1},modelModifiers:{}},emits:H(["onResetLevel"],["update:modelValue"]),setup(e,{emit:a}){const t=J(e,"modelValue"),{audioGameOver:l}=F(),p=a;return w(t,x=>{x&&l()},{immediate:!0}),(x,s)=>(C(),B(X,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=m=>t.value=m),persistent:"","backdrop-filter":"blur(8px)","transition-show":"slide-up","transition-hide":"slide-down","transition-duration":"600"},{default:h(()=>[c(ee,{class:"full-width q-py-md",style:{"max-width":"620px"}},{default:h(()=>[c(Y,{class:"text-center"},{default:h(()=>[c(Z,{srcset:"failedGame.gif",alt:"Happy Birthday",width:"140",height:"140",class:"full-width full-height",style:{"max-width":"140px","max-height":"140px"}}),s[2]||(s[2]=i("p",{class:"text-h4 text-bold text-red-8"},"Você falhou!",-1)),s[3]||(s[3]=i("p",{class:"text-body2 text-bold text-cyan-8"}," Mas não desanime, você pode tentar novamente! ",-1))]),_:1}),c(re,{class:"flex justify-center items-center"},{default:h(()=>[G(c(I,{label:"menu principal",color:"cyan-7",to:"/"},null,512),[[P]]),G(c(I,{label:"jogar novamente",color:"amber-7",onClick:s[0]||(s[0]=m=>p("onResetLevel"))},null,512),[[P]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ue={class:"text-h5 text-bold text-cyan-8 q-px-lg"},Fe={class:"flex justify-center",style:{gap:"10px"}},ze=U({__name:"ModalNextLevel",props:{showModal:{default:!1},showModalModifiers:{}},emits:H(["onNextLevel","onResetLevel"],["update:showModal"]),setup(e,{emit:a}){const t=J(e,"showModal"),l=se(),{currentScore:p,currentLevel:x,attemptCounter:s,gameEndTime:m,gameStartTime:L}=Q(l),f=a;return(S,v)=>(C(),B(X,{modelValue:t.value,"onUpdate:modelValue":v[2]||(v[2]=k=>t.value=k),persistent:"","backdrop-filter":"blur(8px)","transition-show":"slide-up","transition-hide":"slide-down","transition-duration":"600"},{default:h(()=>[c(ee,{class:"full-width q-py-md",style:{"max-width":"620px"}},{default:h(()=>[c(Y,{class:"text-center"},{default:h(()=>[c(Z,{srcset:"happy_birthday.gif",alt:"Happy Birthday",width:"360",height:"360",class:"full-width full-height",style:{"max-width":"250px","max-height":"250px"}}),v[3]||(v[3]=i("p",{class:"text-h4 text-bold text-cyan-8"},"Parabéns!",-1)),i("p",Ue," Você conquistou o nível "+y(n(x)),1),i("div",Fe,[i("p",null,"Pontuação: "+y(n(p)),1),i("p",null,"Tentivas: "+y(n(s)),1),i("p",null,"inicio: "+y(n(L)),1),i("p",null,"fim: "+y(n(m)),1)])]),_:1}),c(re,{class:"flex justify-center items-center"},{default:h(()=>[G(c(I,{label:"Jogar novamente",color:"amber-7","text-color":"black",onClick:v[0]||(v[0]=k=>f("onResetLevel"))},null,512),[[P]]),G(c(I,{label:"Proximo Nivel",color:"cyan-7",onClick:v[1]||(v[1]=k=>f("onNextLevel"))},null,512),[[P]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ae={class:"flex justify-between text-cyan-9 q-pt-md"},Qe=U({__name:"StartGamePage",setup(e){const a=he(),t=se(),{initialFlip:l}=Q(t),{currentScore:p,gridSize:x,levelCardSet:s,currentLevel:m,totalCards:L,lockBoard:f,attemptCounter:S}=Q(t),v=W(),{audioCongratulation:k,audioPair:ne}=F(),M=g([]),_=ve(Array(L.value).fill(!1)),z=g([]),V=g(!1),R=g(!1),j=g(0),E=g(!1);function q(u){const r=[...u];for(let o=r.length-1;o>0;o--){const d=Math.floor(Math.random()*(o+1));[r[o],r[d]]=[r[d],r[o]]}return r}const D=g(q([...s.value]));function ie({index:u,alt:r}){if(!f.value&&(M.value.push({index:u,alt:r}),M.value.length===2)){S.value=S.value+1,f.value=!0;const[o,d]=M.value;o&&d&&(o.alt===d.alt?(_[o.index]=!0,_[d.index]=!0,M.value=[],f.value=!1,t.incrementScore($.value),Ve(),ne()):setTimeout(()=>{z.value[o.index]?.flipDown(),z.value[d.index]?.flipDown(),M.value=[],f.value=!1},1e3))}}return w($,u=>{t.pulseTimerList.forEach(r=>{u===r&&(R.value=!0,setTimeout(()=>{R.value=!1},2e3))})}),w(s,u=>{D.value=q([...u]),_.splice(0,_.length,...Array(u.length).fill(!1))}),w(_,async()=>{_.every(u=>u)&&(V.value=!0,k(),await t.endGame())}),w(l,u=>{if(u){const r=setInterval(()=>{j.value++},600);setTimeout(()=>{clearInterval(r)},5e3)}}),w(le,u=>{u&&!V.value&&(E.value=!E.value)}),ge(async()=>{v.getUser?t.startGameEffects():await a.push("/")}),(u,r)=>(C(),B(oe,{class:"--container"},{default:h(()=>[i("section",null,[i("div",{class:"--grid",style:xe({gridTemplateColumns:`repeat(${n(x)}, minmax(20px, 1fr))`})},[(C(!0),A(ye,null,Se(n(L),(o,d)=>(C(),B(Ie,{key:d,index:d,card:D.value[d]??{src:"",alt:""},"flipped-externally":n(l)||_[d],locked:n(f),onFlip:ie,ref_for:!0,ref_key:"cardRefs",ref:z},null,8,["index","card","flipped-externally","locked"]))),128))],4),i("div",Ae,[i("p",null,"Nivel: "+y(n(m)),1),i("p",null,"Pontuação: "+y(n(p)),1),i("p",null,"Tentativas: "+y(n(S)),1),c(_e,{name:"time-pulse",mode:"out-in"},{default:h(()=>[(C(),A("p",{key:n(l)?"pulse-"+j.value:n($),class:"text-bold"},y(n(l)?n(Te):n($)),1))]),_:1})])]),c(ze,{showModal:V.value,"onUpdate:showModal":r[0]||(r[0]=o=>V.value=o),onOnNextLevel:r[1]||(r[1]=o=>m.value=n(m)+1),onOnResetLevel:n(t).resetLevel},null,8,["showModal","onOnResetLevel"]),c(Pe,{modelValue:E.value,"onUpdate:modelValue":r[2]||(r[2]=o=>E.value=o)},null,8,["modelValue"])]),_:1}))}}),Oe=K(Qe,[["__scopeId","data-v-810973c3"]]);export{Oe as default};
