import{_ as H,Q as oe}from"./_plugin-vue_export-helper-CJYUmXk8.js";import{r as h,c as L,O as ue,d as U,w as g,D as z,L as S,C as n,I as ce,l as de,h as pe,P as fe,Q as me,R as ve,M as J,A as V,B as f,f as u,S as G,z as W,H as m,G as i,o as he,U as ge,V as xe,F as ye,N as Se,W as _e}from"./index-PqqrxjWx.js";import{d as T,u as X,i as Ce,j as we,e as Y,f as Z,Q as ee,h as te}from"./QDialog-BxNUUL1S.js";import{u as be,d as ke,a as Te,Q as A}from"./QBtn-BxuV3RdS.js";import"./firebase-DX09KJgP.js";const ae=60,le=5,b=h(ae),P=h(le),B=L(()=>{const e=Math.floor(b.value/60),a=b.value%60;return`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}`}),Le=L(()=>{const e=P.value%60;return`${String(e).padStart(2,"0")}`}),se=L(()=>b.value<=0);let F=null,I=null;const Q=()=>{clearInterval(F),b.value=ae},re=()=>{clearInterval(I),P.value=le};function O(){return{mounted:()=>{Q(),F=setInterval(()=>{b.value>=0?b.value--:clearInterval(F)},1e3)},mountedStart:()=>{re(),I=setInterval(()=>{P.value>0?P.value--:clearInterval(I)},1e3)},unmounted:()=>{clearInterval(F),clearInterval(I)},isTimeOver:se}}const ie=ue("game",{state:()=>({currentScore:0,pulseTimerList:["01:30","01:00","00:30"],attemptCounter:0,currentLevel:1,gameStartTime:null,gameEndTime:null,initialFlip:!1,lockBoard:!1,flippedStatus:[],flippedCards:[],cardRefs:[],baseFruits:[{src:"fruits/abacaxi.png",alt:"abacaxi"},{src:"fruits/banana.png",alt:"banana"},{src:"fruits/beterraba.png",alt:"beterraba"},{src:"fruits/carambola.png",alt:"carambola"},{src:"fruits/cereja.png",alt:"cereja"},{src:"fruits/kiwi.png",alt:"kiwi"},{src:"fruits/laranja.png",alt:"laranja"},{src:"fruits/limao.png",alt:"limao"},{src:"fruits/manga.png",alt:"manga"},{src:"fruits/melancia.png",alt:"melancia"},{src:"fruits/mixirica.png",alt:"mixirica"},{src:"fruits/morango.png",alt:"morango"},{src:"fruits/pera.png",alt:"pera"},{src:"fruits/pessego.png",alt:"pessego"},{src:"fruits/pitaia.png",alt:"pitaia"},{src:"fruits/tamarindo.png",alt:"tamarindo"},{src:"fruits/uva.png",alt:"uva"},{src:"fruits/uva_roxa.png",alt:"uva roxa"},{src:"fruits/uva_verde.png",alt:"uva verde"}],levelsConfig:[{level:1,gridSize:4,pairs:8},{level:2,gridSize:6,pairs:18},{level:3,gridSize:8,pairs:24},{level:4,gridSize:8,pairs:32}]}),getters:{currentConfig(e){return e.levelsConfig.find(t=>t.level===e.currentLevel)??e.levelsConfig[0]},gridSize(e){return e.levelsConfig.find(a=>a.level===e.currentLevel)?.gridSize||4},totalCards(e){return(e.levelsConfig.find(t=>t.level===e.currentLevel)?.pairs||8)*2},levelCardSet(e){const a=e.levelsConfig.find(l=>l.level===e.currentLevel)?.pairs||8,t=e.baseFruits.slice(0,a);return[...t,...t]},gameDuration(e){return e.gameStartTime!==null&&e.gameEndTime!==null?e.gameEndTime-e.gameStartTime:null}},actions:{startGameEffects(){this.setFlippedStatus();const{audioCard:e,playMusic:a}=T();a(),this.initialFlip=!1,this.lockBoard=!0,setTimeout(()=>{this.gameStartTime=Date.now(),e(),this.initialFlip=!0,O().mountedStart(),setTimeout(()=>{e(),this.initialFlip=!1,O().mounted(),this.lockBoard=!1},5e3)},600)},incrementScore(e){const a=this.calculateScore(e);this.currentScore+=a},calculateScore(e){return e>="00:50"?5:e>="00:40"?4:e>="00:30"?3:e>="00:20"?2:e>="00:05"?1:0},nextLevel(){const e=this.levelsConfig.length;this.currentLevel<e&&this.currentLevel++},resetLevel(){this.currentScore=0,this.attemptCounter=0,this.currentScore=0,Q(),re(),this.setFlippedStatus(),this.startGameEffects()},setFlippedStatus(){this.flippedStatus=Array(this.totalCards).fill(!1)},async endGame(){const e=X();this.gameEndTime=Date.now(),e.getUser?.uid&&await e.updateRanking(e.getUser.uid,{score:this.currentScore,gameTotal:this.gameDuration,attemptCounter:this.attemptCounter,...e.getUser})},onFlip({index:e,alt:a}){if(!this.lockBoard&&(this.flippedCards.push({index:e,alt:a}),this.flippedCards.length===2)){this.attemptCounter=this.attemptCounter+1,this.lockBoard=!0;const[t,l]=this.flippedCards;t&&l&&(t.alt===l.alt?(this.flippedStatus[t.index]=!0,this.flippedStatus[l.index]=!0,this.flippedCards=[],this.lockBoard=!1,this.incrementScore(B.value),Q(),T().audioPair()):setTimeout(()=>{this.cardRefs[t.index]?.flipDown(),this.cardRefs[l.index]?.flipDown(),this.flippedCards=[],this.lockBoard=!1},1e3))}}}}),Me={class:"card-inner"},Ee={class:"card-face card-front"},Be=["src","alt"],Fe=U({__name:"CardIndex",props:{card:{},index:{},flippedExternally:{type:Boolean},locked:{type:Boolean}},emits:["flip"],setup(e,{expose:a,emit:t}){const l=e,d=t,{audioCard:c}=T(),s=h(!1);g(()=>l.flippedExternally,_=>{s.value=_},{immediate:!0});const v=L(()=>s.value?"flip-up":"flip-down");function k(){l.locked||s.value||(s.value=!0,c(),d("flip",{index:l.index,alt:l.card.alt}))}return a({flipDown:()=>{c(),s.value=!1}}),(_,C)=>(S(),z("div",{class:ce(["card-container",v.value]),onClick:k,style:{"min-height":"60px","min-width":"60px"}},[n("div",Me,[C[0]||(C[0]=n("div",{class:"card-face card-back"},null,-1)),n("div",Ee,[n("img",{src:l.card.src,alt:l.card.alt,class:"card-img full-width full-height",width:"80",height:"80",loading:"lazy",style:{"max-width":"80px","max-height":"80px"}},null,8,Be)])])],2))}}),Ie=H(Fe,[["__scopeId","data-v-bf6819fa"]]),ne=de({name:"QCardActions",props:{...be,vertical:Boolean},setup(e,{slots:a}){const t=ke(e),l=L(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>pe("div",{class:l.value},Te(a.default))}});function K(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}const D=fe({name:"close-popup",beforeMount(e,{value:a}){const t={depth:K(a),handler(l){t.depth!==0&&setTimeout(()=>{const d=Ce(e);d!==void 0&&we(d,l,t.depth)})},handlerKey(l){me(l,13)===!0&&t.handler(l)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:a,oldValue:t}){a!==t&&(e.__qclosepopup.depth=K(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}}),Ve=U({__name:"ModalFailedGame",props:{modelValue:{default:!1},modelModifiers:{}},emits:ve(["onResetLevel"],["update:modelValue"]),setup(e,{emit:a}){const t=J(e,"modelValue"),{audioGameOver:l}=T(),d=a;return g(t,c=>{c&&l()},{immediate:!0}),(c,s)=>(S(),V(Y,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=v=>t.value=v),persistent:"","backdrop-filter":"blur(8px)","transition-show":"slide-up","transition-hide":"slide-down","transition-duration":"600"},{default:f(()=>[u(te,{class:"full-width q-py-md",style:{"max-width":"620px"}},{default:f(()=>[u(Z,{class:"text-center"},{default:f(()=>[u(ee,{srcset:"failedGame.gif",alt:"Happy Birthday",width:"140",height:"140",class:"full-width full-height",style:{"max-width":"140px","max-height":"140px"}}),s[2]||(s[2]=n("p",{class:"text-h4 text-bold text-red-8"},"Você falhou!",-1)),s[3]||(s[3]=n("p",{class:"text-body2 text-bold text-cyan-8"}," Mas não desanime, você pode tentar novamente! ",-1))]),_:1}),u(ne,{class:"flex justify-center items-center"},{default:f(()=>[G(u(A,{label:"menu principal",color:"cyan-7",to:"/"},null,512),[[D]]),G(u(A,{label:"jogar novamente",color:"amber-7",onClick:s[0]||(s[0]=v=>d("onResetLevel"))},null,512),[[D]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ge={class:"text-h5 text-bold text-cyan-8 q-px-lg"},Ae={class:"flex justify-center",style:{gap:"10px"}},Pe=U({__name:"ModalNextLevel",props:{showModal:{default:!1},showModalModifiers:{}},emits:["update:showModal"],setup(e){const a=J(e,"showModal"),{audioCongratulation:t}=T(),l=ie(),{currentScore:d,currentLevel:c,attemptCounter:s,gameEndTime:v,gameStartTime:k}=W(l);function _(){t().pause(),l.resetLevel()}function C(){t().pause(),c.value=c.value+1,l.resetLevel()}return g(a,x=>{x&&t()}),(x,w)=>(S(),V(Y,{modelValue:a.value,"onUpdate:modelValue":w[0]||(w[0]=$=>a.value=$),persistent:"","backdrop-filter":"blur(8px)","transition-show":"slide-up","transition-hide":"slide-down","transition-duration":"600"},{default:f(()=>[u(te,{class:"full-width q-py-md",style:{"max-width":"620px"}},{default:f(()=>[u(Z,{class:"text-center"},{default:f(()=>[u(ee,{srcset:"happy_birthday.gif",alt:"Happy Birthday",width:"360",height:"360",class:"full-width full-height",style:{"max-width":"250px","max-height":"250px"}}),w[1]||(w[1]=n("p",{class:"text-h4 text-bold text-cyan-8"},"Parabéns!",-1)),n("p",Ge," Você conquistou o nível "+m(i(c)),1),n("div",Ae,[n("p",null,"Pontuação: "+m(i(d)),1),n("p",null,"Tentivas: "+m(i(s)),1),n("p",null,"inicio: "+m(i(k)),1),n("p",null,"fim: "+m(i(v)),1)])]),_:1}),u(ne,{class:"flex justify-center items-center"},{default:f(()=>[G(u(A,{label:"Jogar novamente",color:"amber-7","text-color":"black",onClick:_},null,512),[[D]]),G(u(A,{label:"Proximo Nivel",color:"cyan-7",onClick:C},null,512),[[D]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),De={class:"flex justify-between text-cyan-9 q-pt-md"},Ue=U({__name:"StartGamePage",setup(e){const a=ge(),t=ie(),{initialFlip:l,currentScore:d,gridSize:c,levelCardSet:s,currentLevel:v,totalCards:k,lockBoard:_,attemptCounter:C,flippedStatus:x,cardRefs:w}=W(t),$=X(),M=h(!1),R=h(!1),j=h(0),E=h(!1);function q(o){const r=[...o];for(let p=r.length-1;p>0;p--){const y=Math.floor(Math.random()*(p+1));[r[p],r[y]]=[r[y],r[p]]}return r}const N=h(q([...s.value]));return g(B,o=>{t.pulseTimerList.forEach(r=>{o===r&&(R.value=!0,setTimeout(()=>{R.value=!1},2e3))})}),g(s,o=>{N.value=q([...o]),x.value.splice(0,x.value.length,...Array(o.length).fill(!1))}),g(()=>x.value,async o=>{console.log(o),console.log(o.every(r=>r)),o.every(r=>r)&&(M.value=!0,await t.endGame())},{deep:!0}),g(l,o=>{if(o){const r=setInterval(()=>{j.value++},600);setTimeout(()=>{clearInterval(r)},5e3)}}),g(se,o=>{o&&!M.value&&(E.value=!E.value)}),he(async()=>{$.getUser?t.startGameEffects():await a.push("/")}),(o,r)=>(S(),V(oe,{class:"--container"},{default:f(()=>[n("section",null,[n("div",{class:"--grid",style:xe({gridTemplateColumns:`repeat(${i(c)}, minmax(20px, 1fr))`})},[(S(!0),z(ye,null,Se(i(k),(p,y)=>(S(),V(Ie,{key:y,index:y,card:N.value[y]??{src:"",alt:""},"flipped-externally":i(l)||i(x)[y],locked:i(_),onFlip:i(t).onFlip,ref_for:!0,ref_key:"cardRefs",ref:w},null,8,["index","card","flipped-externally","locked","onFlip"]))),128))],4),n("div",De,[n("p",null,"Nivel: "+m(i(v)),1),n("p",null,"Pontuação: "+m(i(d)),1),n("p",null,"Tentativas: "+m(i(C)),1),u(_e,{name:"time-pulse",mode:"out-in"},{default:f(()=>[(S(),z("p",{key:i(l)?"pulse-"+j.value:i(B),class:"text-bold"},m(i(l)?i(Le):i(B)),1))]),_:1})])]),u(Pe,{showModal:M.value,"onUpdate:showModal":r[0]||(r[0]=p=>M.value=p)},null,8,["showModal"]),u(Ve,{modelValue:E.value,"onUpdate:modelValue":r[1]||(r[1]=p=>E.value=p)},null,8,["modelValue"])]),_:1}))}}),qe=H(Ue,[["__scopeId","data-v-e1854c99"]]);export{qe as default};
