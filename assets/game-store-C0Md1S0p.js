import{r as f,c,$ as v}from"./index-sCHZgQMg.js";import{a as o,u as S}from"./user-store-BV8SjkVX.js";const d=60,m=5,i=f(d),l=f(m),h=c(()=>{const e=Math.floor(i.value/60),t=i.value%60;return`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}`}),L=c(()=>{const e=l.value%60;return`${String(e).padStart(2,"0")}`}),C=c(()=>i.value<=0);let s=null,n=null;const u=()=>{clearInterval(s),i.value=d},g=()=>{clearInterval(n),l.value=m};function p(){return{mounted:()=>{u(),s=setInterval(()=>{i.value>=0?i.value--:clearInterval(s)},1e3)},mountedStart:()=>{g(),n=setInterval(()=>{l.value>0?l.value--:clearInterval(n)},1e3)},unmounted:()=>{clearInterval(s),clearInterval(n)},isTimeOver:C}}const x=v("game",{state:()=>({currentScore:0,pulseTimerList:["01:30","01:00","00:30"],attemptCounter:0,currentLevel:1,gameStartTime:null,gameEndTime:null,initialFlip:!1,lockBoard:!1,flippedStatus:[],flippedCards:[],cardRefs:[],baseFruits:[{src:"fruits/abacaxi.png",alt:"abacaxi"},{src:"fruits/banana.png",alt:"banana"},{src:"fruits/beterraba.png",alt:"beterraba"},{src:"fruits/carambola.png",alt:"carambola"},{src:"fruits/cereja.png",alt:"cereja"},{src:"fruits/kiwi.png",alt:"kiwi"},{src:"fruits/laranja.png",alt:"laranja"},{src:"fruits/limao.png",alt:"limao"},{src:"fruits/manga.png",alt:"manga"},{src:"fruits/melancia.png",alt:"melancia"},{src:"fruits/mixirica.png",alt:"mixirica"},{src:"fruits/morango.png",alt:"morango"},{src:"fruits/pera.png",alt:"pera"},{src:"fruits/pessego.png",alt:"pessego"},{src:"fruits/pitaia.png",alt:"pitaia"},{src:"fruits/tamarindo.png",alt:"tamarindo"},{src:"fruits/uva.png",alt:"uva"},{src:"fruits/uva_roxa.png",alt:"uva roxa"},{src:"fruits/uva_verde.png",alt:"uva verde"},{src:"fruits/jabuticaba.png",alt:"jabuticaba"},{src:"fruits/maca_verde.png",alt:"maca_verde"},{src:"fruits/melancia_cortada.png",alt:"melancia cortada"},{src:"fruits/goiaba.png",alt:"goiaba cortada"},{src:"fruits/lichia.png",alt:"lichia"}],levelsConfig:[{level:1,gridSize:4,pairs:8},{level:2,gridSize:6,pairs:18},{level:3,gridSize:8,pairs:24}]}),getters:{currentConfig(e){return e.levelsConfig.find(r=>r.level===e.currentLevel)??e.levelsConfig[0]},gridSize(e){return e.levelsConfig.find(t=>t.level===e.currentLevel)?.gridSize||4},totalCards(e){return(e.levelsConfig.find(r=>r.level===e.currentLevel)?.pairs||8)*2},levelCardSet(e){const t=e.levelsConfig.find(a=>a.level===e.currentLevel)?.pairs||8,r=e.baseFruits.slice(0,t);return[...r,...r]},gameDuration(e){return e.gameStartTime!==null&&e.gameEndTime!==null?e.gameEndTime-e.gameStartTime:null}},actions:{startGameEffects(){const{audioCard:e,playMusic:t}=o();t(),this.resetLevel(),this.initialFlip=!1,this.lockBoard=!0,setTimeout(()=>{this.gameStartTime=Date.now(),e(),this.initialFlip=!0,p().mountedStart(),setTimeout(()=>{e(),this.initialFlip=!1,p().mounted(),this.lockBoard=!1},5e3)},600)},async endGame(){const e=S();e.getUser&&(this.gameEndTime=Date.now(),e.getUser?.uid&&await e.updateRanking(e.getUser.uid,{score:this.currentScore,gameTotal:this.gameDuration,attemptCounter:this.attemptCounter,...e.getUser}))},incrementScore(e){const t=this.calculateScore(e);this.currentScore+=t},calculateScore(e){return e>="00:50"?5:e>="00:40"?4:e>="00:30"?3:e>="00:20"?2:e>="00:05"?1:0},resetLevel(){this.currentScore=0,this.attemptCounter=0,this.currentScore=0,u(),g(),this.setFlippedStatus()},setFlippedStatus(){this.flippedStatus=Array(this.totalCards).fill(!1)},onFlip({index:e,alt:t}){if(!this.lockBoard&&(this.flippedCards.push({index:e,alt:t}),this.flippedCards.length===2)){this.attemptCounter=this.attemptCounter+1,this.lockBoard=!0;const[r,a]=this.flippedCards;r&&a&&(r.alt===a.alt?(this.flippedStatus[r.index]=!0,this.flippedStatus[a.index]=!0,this.flippedCards=[],this.lockBoard=!1,this.incrementScore(h.value),u(),o().audioPair()):setTimeout(()=>{this.cardRefs[r.index]?.flipDown(),this.cardRefs[a.index]?.flipDown(),this.flippedCards=[],this.lockBoard=!1},1e3))}}}});export{L as a,h as f,C as i,x as u};
