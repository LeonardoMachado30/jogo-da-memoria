import{r as d,c as u,a0 as h}from"./index-BV73M5ur.js";import{a as c,u as T}from"./user-store-Bafw2TTh.js";const f=60,m=5,i=d(f),l=d(m),C=u(()=>{const t=Math.floor(i.value/60),e=i.value%60;return`${String(t).padStart(2,"0")}:${String(e).padStart(2,"0")}`}),F=u(()=>{const t=l.value%60;return`${String(t).padStart(2,"0")}`}),b=u(()=>i.value<=0);let s=null,n=null;const o=()=>{clearInterval(s),i.value=f},g=()=>{clearInterval(n),l.value=m};function p(){return{mounted:()=>{o(),s=setInterval(()=>{i.value>=0?i.value--:clearInterval(s)},1e3)},mountedStart:()=>{g(),n=setInterval(()=>{l.value>0?l.value--:clearInterval(n)},1e3)},unmounted:()=>{clearInterval(s),clearInterval(n)},isTimeOver:b}}const k=h("game",{state:()=>({currentScore:0,pulseTimerList:["01:30","01:00","00:30"],attemptCounter:0,currentLevel:1,gameStartTime:0,gameEndTime:0,initialFlip:!1,lockBoard:!1,flippedStatus:[],flippedCards:[],cardRefs:[],baseFruits:[{src:"fruits/abacaxi.png",alt:"abacaxi"},{src:"fruits/banana.png",alt:"banana"},{src:"fruits/beterraba.png",alt:"beterraba"},{src:"fruits/carambola.png",alt:"carambola"},{src:"fruits/cereja.png",alt:"cereja"},{src:"fruits/kiwi.png",alt:"kiwi"},{src:"fruits/laranja.png",alt:"laranja"},{src:"fruits/limao.png",alt:"limao"},{src:"fruits/manga.png",alt:"manga"},{src:"fruits/melancia.png",alt:"melancia"},{src:"fruits/mixirica.png",alt:"mixirica"},{src:"fruits/morango.png",alt:"morango"},{src:"fruits/pera.png",alt:"pera"},{src:"fruits/pessego.png",alt:"pessego"},{src:"fruits/pitaia.png",alt:"pitaia"},{src:"fruits/tamarindo.png",alt:"tamarindo"},{src:"fruits/uva.png",alt:"uva"},{src:"fruits/uva_roxa.png",alt:"uva roxa"},{src:"fruits/uva_verde.png",alt:"uva verde"},{src:"fruits/jabuticaba.png",alt:"jabuticaba"},{src:"fruits/maca_verde.png",alt:"maca_verde"},{src:"fruits/melancia_cortada.png",alt:"melancia cortada"},{src:"fruits/goiaba.png",alt:"goiaba cortada"},{src:"fruits/lichia.png",alt:"lichia"}],levelsConfig:[{level:1,gridSize:4,pairs:8},{level:2,gridSize:6,pairs:18},{level:3,gridSize:8,pairs:24}]}),getters:{currentConfig(t){return t.levelsConfig.find(r=>r.level===t.currentLevel)??t.levelsConfig[0]},gridSize(t){return t.levelsConfig.find(e=>e.level===t.currentLevel)?.gridSize||4},totalCards(t){return(t.levelsConfig.find(r=>r.level===t.currentLevel)?.pairs||8)*2},levelCardSet(t){const e=t.levelsConfig.find(a=>a.level===t.currentLevel)?.pairs||8,r=t.baseFruits.slice(0,e);return[...r,...r]},gameDuration(t){return t.gameStartTime!==null&&t.gameEndTime!==null?t.gameEndTime-t.gameStartTime:null}},actions:{startGameEffects(){const{audioCard:t,playMusic:e}=c();e(),this.resetLevel(),this.initialFlip=!1,this.lockBoard=!0,setTimeout(()=>{this.gameStartTime=Date.now(),t(),this.initialFlip=!0,p().mountedStart(),setTimeout(()=>{t(),this.initialFlip=!1,p().mounted(),this.lockBoard=!1},5e3)},600)},async endGame(){const t=T();if(t.getUser){this.gameEndTime=Date.now();const e=this.gameTimeConvertForMinutes(this.gameStartTime,this.gameEndTime);t.getUser?.uid&&await t.updateRanking(t.getUser.uid,{score:this.currentScore,gameTotal:e,attemptCounter:this.attemptCounter,...t.getUser})}},incrementScore(t){const e=this.calculateScore(t);this.currentScore+=e},calculateScore(t){return t>="00:50"?5:t>="00:40"?4:t>="00:30"?3:t>="00:20"?2:t>="00:05"?1:0},resetLevel(){this.currentScore=0,this.attemptCounter=0,this.currentScore=0,o(),g(),this.setFlippedStatus()},setFlippedStatus(){this.flippedStatus=Array(this.totalCards).fill(!1)},onFlip({index:t,alt:e}){if(!this.lockBoard&&(this.flippedCards.push({index:t,alt:e}),this.flippedCards.length===2)){this.attemptCounter=this.attemptCounter+1,this.lockBoard=!0;const[r,a]=this.flippedCards;r&&a&&(r.alt===a.alt?(this.flippedStatus[r.index]=!0,this.flippedStatus[a.index]=!0,this.flippedCards=[],this.lockBoard=!1,this.incrementScore(C.value),o(),c().audioPair()):setTimeout(()=>{this.cardRefs[r.index]?.flipDown(),this.cardRefs[a.index]?.flipDown(),this.flippedCards=[],this.lockBoard=!1},1e3))}},gameTimeConvertForMinutes(t,e){const r=e-t,a=Math.floor(r/1e3),v=Math.floor(a/60),S=a%60;return`${String(v).padStart(2,"0")}:${String(S).padStart(2,"0")}`}}});export{F as a,C as f,b as i,k as u};
