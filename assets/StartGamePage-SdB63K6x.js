import{_ as K,Q as ie}from"./_plugin-vue_export-helper-CYsfbCkq.js";import{r as g,c as T,O as ue,d as U,w as C,D as z,L as w,C as o,I as ce,l as de,h as pe,P as fe,Q as me,R as H,M as J,A as B,B as h,f as c,S as G,z as A,H as y,G as n,y as ve,o as ge,U as he,V as xe,W as ye,F as Se,N as _e}from"./index-CmUaKe6d.js";import{u as W,d as j,i as Ce,j as we,e as X,f as Y,Q as Z,h as ee}from"./QDialog-Bj_0GRGR.js";import{u as be,d as Le,a as ke,Q as I}from"./QBtn-Bc4UKBTA.js";import"./firebase-D-xi5DSr.js";const te=60,Me=5,b=g(te),ae=g(Me),$=T(()=>{const e=Math.floor(b.value/60),a=b.value%60;return`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}`}),Te=T(()=>{const e=ae.value%60;return`${String(e).padStart(2,"0")}`}),le=T(()=>b.value<=0),Ve=()=>{b.value=te};function q(){let e=null,a=null;return{mounted:()=>{e=setInterval(()=>{b.value>=0?b.value--:e&&clearInterval(e)},500)},unmounted:()=>{e&&clearInterval(e)},mountedStart:()=>{a=setInterval(()=>{b.value>0?ae.value--:a&&clearInterval(a)},1e3)},isTimeOver:le}}const se=ue("game",{state:()=>({currentScore:0,pulseTimerList:["01:30","01:00","00:30"],attemptCounter:0,currentLevel:1,gameStartTime:null,gameEndTime:null,initialFlip:!1,lockBoard:!1,baseFruits:[{src:"/fruits/melancia.png",alt:"melancia"},{src:"/fruits/morango.png",alt:"morango"},{src:"/fruits/maca.png",alt:"maça"},{src:"/fruits/laranja.png",alt:"laranja"},{src:"/fruits/banana.png",alt:"banana"},{src:"/fruits/uva.png",alt:"uva"},{src:"/fruits/cereja.png",alt:"cereja"},{src:"/fruits/abacaxi.png",alt:"abacaxi"},{src:"/fruits/kiwi.png",alt:"kiwi"},{src:"/fruits/limao.png",alt:"limão"},{src:"/fruits/goiaba.png",alt:"goiaba"},{src:"/fruits/manga.png",alt:"manga"},{src:"/fruits/pera.png",alt:"pera"},{src:"/fruits/figo.png",alt:"figo"},{src:"/fruits/ameixa.png",alt:"ameixa"},{src:"/fruits/tamarindo.png",alt:"tamarindo"},{src:"/fruits/framboesa.png",alt:"framboesa"},{src:"/fruits/maracuja.png",alt:"maracujá"}],levelsConfig:[{level:1,gridSize:4,pairs:8},{level:2,gridSize:6,pairs:18},{level:3,gridSize:8,pairs:24},{level:4,gridSize:8,pairs:32}]}),getters:{currentConfig(e){return e.levelsConfig.find(t=>t.level===e.currentLevel)??e.levelsConfig[0]},gridSize(e){return e.levelsConfig.find(a=>a.level===e.currentLevel)?.gridSize||4},totalCards(e){return(e.levelsConfig.find(t=>t.level===e.currentLevel)?.pairs||8)*2},levelCardSet(e){const a=e.levelsConfig.find(l=>l.level===e.currentLevel)?.pairs||8,t=e.baseFruits.slice(0,a);return[...t,...t]}},actions:{startGameEffects(){const{audioCard:e}=j();this.initialFlip=!1,this.lockBoard=!0,setTimeout(()=>{this.gameStartTime=Date.now(),e(),this.initialFlip=!0,q().mountedStart(),setTimeout(()=>{e(),this.initialFlip=!1,q().mounted(),this.lockBoard=!1},5e3)},2e3)},incremetAttemptCounter(){this.attemptCounter+=1},incrementScore(e){const a=this.calculateScore(e);this.currentScore+=a},calculateScore(e){return e>="00:50"?5:e>="00:40"?4:e>="00:30"?3:e>="00:20"?2:e>="00:05"?1:0},resetScore(){this.currentScore=0},nextLevel(){const e=this.levelsConfig.length;this.currentLevel<e&&this.currentLevel++},resetLevel(){this.currentScore=0,this.resetScore(),this.startGameEffects()},async endGame(){console.log("start end game");const e=W();this.gameEndTime=Date.now(),console.log(e.getUser?.uid),e.getUser?.uid&&await e.updateRanking(e.getUser.uid,{score:this.currentScore,gameTotal:this.attemptCounter,attemptCounter:this.attemptCounter,...e.getUser})}}}),Ee={class:"card-inner"},$e={class:"card-face card-front"},Be=["src","alt"],Ge=U({__name:"CardIndex",props:{card:{},index:{},flippedExternally:{type:Boolean},locked:{type:Boolean}},emits:["flip"],setup(e,{expose:a,emit:t}){const l=e,p=t,{audioCard:x}=j(),s=g(!1);C(()=>l.flippedExternally,f=>{s.value=f},{immediate:!0});const m=T(()=>s.value?"flip-up":"flip-down");function L(){l.locked||s.value||(s.value=!0,x(),p("flip",{index:l.index,alt:l.card.alt}))}return a({flipDown:()=>{x(),s.value=!1}}),(f,S)=>(w(),z("div",{class:ce(["card-container",m.value]),onClick:L,style:{"min-height":"60px","min-width":"60px"}},[o("div",Ee,[S[0]||(S[0]=o("div",{class:"card-face card-back"},null,-1)),o("div",$e,[o("img",{src:l.card.src,alt:l.card.alt,class:"card-img",width:"80",height:"80",loading:"lazy"},null,8,Be)])])],2))}}),Ie=K(Ge,[["__scopeId","data-v-585f4d5c"]]),re=de({name:"QCardActions",props:{...be,vertical:Boolean},setup(e,{slots:a}){const t=Le(e),l=T(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>pe("div",{class:l.value},ke(a.default))}});function O(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}const P=fe({name:"close-popup",beforeMount(e,{value:a}){const t={depth:O(a),handler(l){t.depth!==0&&setTimeout(()=>{const p=Ce(e);p!==void 0&&we(p,l,t.depth)})},handlerKey(l){me(l,13)===!0&&t.handler(l)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:a,oldValue:t}){a!==t&&(e.__qclosepopup.depth=O(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}}),Pe=U({__name:"ModalFailedGame",props:{modelValue:{default:!1},modelModifiers:{}},emits:H(["onResetLevel"],["update:modelValue"]),setup(e,{emit:a}){const t=J(e,"modelValue"),{audioGameOver:l}=j(),p=a;return C(t,x=>{x&&l()},{immediate:!0}),(x,s)=>(w(),B(X,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=m=>t.value=m),persistent:"","backdrop-filter":"blur(8px)","transition-show":"slide-up","transition-hide":"slide-down","transition-duration":"600"},{default:h(()=>[c(ee,{class:"full-width q-py-md",style:{"max-width":"620px"}},{default:h(()=>[c(Y,{class:"text-center"},{default:h(()=>[c(Z,{srcset:"/failedGame.gif",alt:"Happy Birthday",width:"140",height:"140",class:"full-width full-height",style:{"max-width":"140px","max-height":"140px"}}),s[2]||(s[2]=o("p",{class:"text-h4 text-bold text-red-8"},"Você falhou!",-1)),s[3]||(s[3]=o("p",{class:"text-body2 text-bold text-cyan-8"}," Mas não desanime, você pode tentar novamente! ",-1))]),_:1}),c(re,{class:"flex justify-center items-center"},{default:h(()=>[G(c(I,{label:"menu principal",color:"cyan-7",to:"/"},null,512),[[P]]),G(c(I,{label:"jogar novamente",color:"amber-7",onClick:s[0]||(s[0]=m=>p("onResetLevel"))},null,512),[[P]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ue={class:"text-h5 text-bold text-cyan-8 q-px-lg"},je={class:"flex justify-center",style:{gap:"10px"}},Fe=U({__name:"ModalNextLevel",props:{showModal:{default:!1},showModalModifiers:{}},emits:H(["onNextLevel","onResetLevel"],["update:showModal"]),setup(e,{emit:a}){const t=J(e,"showModal"),l=se(),{currentScore:p,currentLevel:x,attemptCounter:s,gameEndTime:m,gameStartTime:L}=A(l),f=a;return(S,v)=>(w(),B(X,{modelValue:t.value,"onUpdate:modelValue":v[2]||(v[2]=k=>t.value=k),persistent:"","backdrop-filter":"blur(8px)","transition-show":"slide-up","transition-hide":"slide-down","transition-duration":"600"},{default:h(()=>[c(ee,{class:"full-width q-py-md",style:{"max-width":"620px"}},{default:h(()=>[c(Y,{class:"text-center"},{default:h(()=>[c(Z,{srcset:"/happy_birthday.gif",alt:"Happy Birthday",width:"360",height:"360",class:"full-width full-height",style:{"max-width":"250px","max-height":"250px"}}),v[3]||(v[3]=o("p",{class:"text-h4 text-bold text-cyan-8"},"Parabéns!",-1)),o("p",Ue," Você conquistou o nível "+y(n(x)),1),o("div",je,[o("p",null,"Pontuação: "+y(n(p)),1),o("p",null,"Tentivas: "+y(n(s)),1),o("p",null,"inicio: "+y(n(L)),1),o("p",null,"fim: "+y(n(m)),1)])]),_:1}),c(re,{class:"flex justify-center items-center"},{default:h(()=>[G(c(I,{label:"Jogar novamente",color:"amber-7","text-color":"black",onClick:v[0]||(v[0]=k=>f("onResetLevel"))},null,512),[[P]]),G(c(I,{label:"Proximo Nivel",color:"cyan-7",onClick:v[1]||(v[1]=k=>f("onNextLevel"))},null,512),[[P]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ze={class:"flex justify-between text-cyan-9"},Ae=U({__name:"StartGamePage",setup(e){const a=he(),t=se(),{initialFlip:l}=A(t),{currentScore:p,gridSize:x,levelCardSet:s,currentLevel:m,totalCards:L,lockBoard:f,attemptCounter:S}=A(t),v=W(),{audioCongratulation:k,audioPair:ne}=j(),M=g([]),_=ve(Array(L.value).fill(!1)),F=g([]),V=g(!1),Q=g(!1),R=g(0),E=g(!1);function D(u){const r=[...u];for(let i=r.length-1;i>0;i--){const d=Math.floor(Math.random()*(i+1));[r[i],r[d]]=[r[d],r[i]]}return r}const N=g(D([...s.value]));function oe({index:u,alt:r}){if(!f.value&&(M.value.push({index:u,alt:r}),M.value.length===2)){S.value=S.value+1,f.value=!0;const[i,d]=M.value;i&&d&&(i.alt===d.alt?(_[i.index]=!0,_[d.index]=!0,M.value=[],f.value=!1,t.incrementScore($.value),Ve(),ne()):setTimeout(()=>{F.value[i.index]?.flipDown(),F.value[d.index]?.flipDown(),M.value=[],f.value=!1},1e3))}}return C($,u=>{t.pulseTimerList.forEach(r=>{u===r&&(Q.value=!0,setTimeout(()=>{Q.value=!1},2e3))})}),C(s,u=>{N.value=D([...u]),_.splice(0,_.length,...Array(u.length).fill(!1))}),C(_,async()=>{_.every(u=>u)&&(V.value=!0,k(),await t.endGame())}),C(l,u=>{if(u){const r=setInterval(()=>{R.value++},600);setTimeout(()=>{clearInterval(r)},5e3)}}),C(le,u=>{u&&!V.value&&(E.value=!E.value)}),ge(async()=>{v.getUser?t.startGameEffects():await a.push("/")}),(u,r)=>(w(),B(ie,{class:"--container"},{default:h(()=>[o("section",null,[o("div",ze,[o("p",null,"Nivel: "+y(n(m)),1),o("p",null,"Pontuação: "+y(n(p)),1),o("p",null,"Tentativas: "+y(n(S)),1),c(xe,{name:"time-pulse",mode:"out-in"},{default:h(()=>[(w(),z("p",{key:n(l)?"pulse-"+R.value:n($),class:"text-bold"},y(n(l)?n(Te):n($)),1))]),_:1})]),o("div",{class:"--grid",style:ye({gridTemplateColumns:`repeat(${n(x)}, 1fr)`})},[(w(!0),z(Se,null,_e(n(L),(i,d)=>(w(),B(Ie,{key:d,index:d,card:N.value[d]??{src:"",alt:""},"flipped-externally":n(l)||_[d],locked:n(f),onFlip:oe,ref_for:!0,ref_key:"cardRefs",ref:F},null,8,["index","card","flipped-externally","locked"]))),128))],4)]),c(Fe,{showModal:V.value,"onUpdate:showModal":r[0]||(r[0]=i=>V.value=i),onOnNextLevel:r[1]||(r[1]=i=>m.value=n(m)+1),onOnResetLevel:n(t).resetLevel},null,8,["showModal","onOnResetLevel"]),c(Pe,{modelValue:E.value,"onUpdate:modelValue":r[2]||(r[2]=i=>E.value=i)},null,8,["modelValue"])]),_:1}))}}),Oe=K(Ae,[["__scopeId","data-v-a6c7c49f"]]);export{Oe as default};
